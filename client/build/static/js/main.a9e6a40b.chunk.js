(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{117:function(e,t){},118:function(e,t){},154:function(e,t,n){e.exports=n(254)},159:function(e,t,n){},161:function(e,t,n){},162:function(e,t,n){},163:function(e,t,n){},164:function(e,t,n){},172:function(e,t){},173:function(e,t,n){},254:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(23),i=n.n(r),c=(n(159),n(36)),o=n.n(c),u=n(12),l=n(13),p=n(15),d=n(14),h=n(16),m=(n(161),n(82)),f=n(142),v=n(10),y=(n(162),n(20)),b=(n(163),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={typedText:"",fullText:n.props.text,index:0,timeOuts:[]},n.textRef=s.a.createRef(),n.typingText=n.typingText.bind(Object(v.a)(n)),n.showFullText=n.showFullText.bind(Object(v.a)(n)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.typingText(),document.addEventListener("keydown",this.showFullText)}},{key:"componentDidUpdate",value:function(){this.textRef.current.scrollIntoView()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.showFullText)}},{key:"typingText",value:function(){var e=this;this.state.index<this.props.text.length?this.setState((function(t){return{typedText:t.typedText+t.fullText.charAt(t.index),index:t.index+1,timeOuts:[].concat(Object(y.a)(t.timeOuts),[setTimeout(e.typingText,20)])}})):setTimeout(this.props.doneTyping,20)}},{key:"showFullText",value:function(e){if(13===e.keyCode){for(var t=0;t<this.state.timeOuts.length;t++)window.clearTimeout(this.state.timeOuts[t]);this.setState({typedText:this.state.fullText}),setTimeout(this.props.doneTyping,20)}}},{key:"render",value:function(){return s.a.createElement("div",{className:"typing-text",ref:this.textRef},this.state.typedText&&this.state.typedText.split("\n").map((function(e,t){return s.a.createElement("div",{className:"text",key:t},e)})))}}]),t}(a.Component)),g=(n(164),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={userInput:!1,currCommand:n.props.commandNum},n.userInputRef=s.a.createRef(),n.updateUserInputHeight=n.updateUserInputHeight.bind(Object(v.a)(n)),n.getUserInput=n.getUserInput.bind(Object(v.a)(n)),n.handleUserInput=n.handleUserInput.bind(Object(v.a)(n)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.state.userInput&&this.userInputRef.current&&this.userInputRef.current.addEventListener("input",this.updateUserInputHeight)}},{key:"componentWillUnmount",value:function(){this.userInputRef.current.removeEventListener("input",this.updateUserInputHeight)}},{key:"updateUserInputHeight",value:function(){this.userInputRef.current.style.height="".concat(this.userInputRef.current.scrollHeight,"px")}},{key:"getUserInput",value:function(){this.setState({userInput:!0}),this.userInputRef.current&&this.userInputRef.current.focus()}},{key:"handleUserInput",value:function(e){if(13!==e.keyCode||this.userInputRef.current.readOnly){if(38===e.keyCode){var t=this.state.currCommand-1;t>=0&&(this.userInputRef.current.value=this.props.commands[t],this.setState((function(e){return{currCommand:e.currCommand-1}})))}else if(40===e.keyCode){var n=this.state.currCommand+1;n<this.props.commands.length&&(this.userInputRef.current.value=this.props.commands[n],this.setState((function(e){return{currCommand:e.currCommand+1}})))}}else e.preventDefault(),this.userInputRef.current.blur(),this.props.handleUserInput(this.userInputRef.current.value)}},{key:"render",value:function(){return s.a.createElement("div",{className:"command-line-text"},s.a.createElement(b,{text:this.props.prompt,doneTyping:this.getUserInput}),this.state.userInput&&s.a.createElement("div",{style:{position:"relative"}},s.a.createElement("div",{style:{position:"absolute",display:"inline-block"}},">"),s.a.createElement("textarea",{rows:"1",spellCheck:"false",readOnly:!this.props.blink,className:"command-line-user-input",onKeyDown:this.handleUserInput,ref:this.userInputRef})))}}]),t}(a.Component)),I=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={prompts:["Welcome to Interactive CDCL! To skip introduction/text animation, press Enter key.\n      \n\n      This is a CDCL SAT solver that illustrates the implication graphs of given CNF clauses.\n      \n\n      It's built by Jace and Lisa as final project for Princeton COS 516(Automated Reasoning about Software) taught by professor Aarti!\n      \n\n      To add a clause, type 'add [CLAUSE]' (e.g. add x1 or not x2 or x5).\n      \n\n      To remove a clause, type 'del [CLAUSE_LABEL]' (e.g. del clause3). Note clauses will be reordered after deletion.\n      \n\n      To list current clauses you have, type 'list'.\n      \n\n      Once you're done, type 'run' to compute current clauses and visualize the implication graph.\n      \n\n      If you need help, type 'help'."],commands:[]},n.validateUserInput=n.validateUserInput.bind(Object(v.a)(n)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"validateUserInput",value:function(e){var t=this,n=e.trim().split(/\s+/),a=n[0].toLowerCase();if(this.setState((function(t){return{commands:[].concat(Object(y.a)(t.commands),[e])}})),"run"===e.trim().toLowerCase())"{}"===JSON.stringify(this.props.clauses)?this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Can't build a graph with zero clauses."])}})):this.props.submitClauses();else if("add"===a){var s=n.slice(1).join(" ");s&&0!==s.replace(/\s/g,"").length?/^ *(?:not )?x\d+(?: or (?:not )?x\d+)* *$/.test(s)?(this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Clause '".concat(s,"' added!")])}})),this.props.addClause(s)):this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Make sure to use all lower case letters, all your variables begin with x, end with a positive integer and since it's CNF form, you can only use 'not' and 'or' in your clauses!"])}})):this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Clause input field cannot be empty!"])}}))}else if("del"===a){var r=n[1];if(r)if(this.props.clauses[r]){var i=this.props.clauses[r];this.props.deleteClause(r),this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Clause ".concat(i," has been deleted! Your current clauses have been reordered.")])}}))}else this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Invalid clause label. Use command 'list' to check available clause label you have."])}}));else this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Invalid delete clause command. You need to specify a clause label(e.g. del clause3)."])}}))}else if("list"===e.trim().toLowerCase())this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),[JSON.stringify(t.props.clauses)])}}));else if("help"===e.trim().toLowerCase()){this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["To skip text animation, press Enter key.\n      \n\n      To add a clause, type 'add [CLAUSE]' (e.g. add x1 or not x2 or x5).\n      \n\n      To remove a clause, type 'del [CLAUSE_LABEL]' (e.g. del clause3). Note clauses will be reordered after deletion.\n      \n\n      To list current clauses you have, type 'list'.\n      \n\n      Once you're done, type 'run' to compute current clauses and visualize the implication graph.\n      \n\n      If you need help, type 'help'."])}}))}else this.setState((function(e){return{prompts:[].concat(Object(y.a)(e.prompts),["Invalid command. Type 'help' to see your available options."])}}))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"terminal-window-container"},s.a.createElement("div",{className:"terminal-window-header"},s.a.createElement("div",{className:"title"},"Interactive CDCL")),s.a.createElement("div",{className:"terminal-window"},this.state.prompts.map((function(t,n){return s.a.createElement(g,{key:"prompt-".concat(n),prompt:t,commandNum:n,commands:e.state.commands,blink:n===e.state.prompts.length-1,handleUserInput:e.validateUserInput})}))))}}]),t}(a.Component),x=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={clauseNum:1,inputs:{}},n.addClause=n.addClause.bind(Object(v.a)(n)),n.deleteClause=n.deleteClause.bind(Object(v.a)(n)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"addClause",value:function(e){this.setState((function(t){return{inputs:Object(f.a)({},t.inputs,Object(m.a)({},"clause".concat(t.clauseNum),e)),clauseNum:t.clauseNum+1}}))}},{key:"deleteClause",value:function(e){var t=Object.assign({},this.state.inputs);delete t[e],t=this.reorderClauses(t),this.setState((function(e){return{inputs:t,clauseNum:e.clauseNum-1}}))}},{key:"reorderClauses",value:function(e){return Object.fromEntries(Object.values(e).map((function(e,t){return["clause".concat(t+1),e]})))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"graph-input-container"},s.a.createElement(I,{clauses:this.state.inputs,addClause:this.addClause,deleteClause:this.deleteClause,submitClauses:function(){return e.props.onSubmit(e.state.inputs)}}))}}]),t}(a.Component),C=n(148),E=n(87),O=(n(165),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={graphviz:null},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"setGraph",value:function(){this.state.graphviz.renderDot(this.props.dotStr)}},{key:"componentDidMount",value:function(){var e=E.b(".graph").graphviz().transition((function(){return E.c("main").ease(E.a).delay(500).duration(500)})).on("initEnd",this.setGraph);this.setState({graphviz:e})}},{key:"componentDidUpdate",value:function(){this.setGraph()}},{key:"render",value:function(){return s.a.createElement("div",{className:"graph"},s.a.createElement("script",{src:"https://unpkg.com/viz.js@1.8.0/viz.js",type:"javascript/worker"}))}}]),t}(a.Component)),S=n(256),j=n(257),k=n(258),w=n(259),T=n(260),R=n(261),N=(n(173),function(e){function t(e){var n;Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={clauseStrs:e.clauseInfo.data.clauses,graphStrs:e.clauseInfo.data.stepGraphs,contIndices:e.clauseInfo.data.contIndices.slice(0,e.clauseInfo.data.contIndices.length-1),confClauses:e.clauseInfo.data.confClauses,isSat:e.clauseInfo.data.isSat,graphIndex:0},n.clauseRef=s.a.createRef(),n.dragMouseDown=n.dragMouseDown.bind(Object(v.a)(n)),n.elementDrag=n.elementDrag.bind(Object(v.a)(n)),n.closeDragElement=n.closeDragElement.bind(Object(v.a)(n)),n.pos1=n.pos2=n.pos3=n.pos4=0,n.conflictRefs=[];for(var a=0;a<e.clauseInfo.data.contIndices.length-1;a++)n.conflictRefs.push(s.a.createRef());return n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.clauseRef.current.onmousedown=this.dragMouseDown}},{key:"componentDidUpdate",value:function(e,t){if(t.graphIndex!==this.state.graphIndex){var n=this.state.contIndices.indexOf(this.state.graphIndex);n>=0&&this.conflictRefs[n].current.scrollIntoView()}}},{key:"dragMouseDown",value:function(e){(e=e||window.event).preventDefault(),this.pos3=e.clientX,this.pos4=e.clientY,document.onmouseup=this.closeDragElement,document.onmousemove=this.elementDrag}},{key:"elementDrag",value:function(e){(e=e||window.event).preventDefault(),this.pos1=this.pos3-e.clientX,this.pos2=this.pos4-e.clientY,this.pos3=e.clientX,this.pos4=e.clientY,this.clauseRef.current.style.top=this.clauseRef.current.offsetTop-this.pos2+"px",this.clauseRef.current.style.left=this.clauseRef.current.offsetLeft-this.pos1+"px"}},{key:"closeDragElement",value:function(){document.onmouseup=null,document.onmousemove=null}},{key:"prevStep",value:function(){this.setState((function(e){return{graphIndex:e.graphIndex-1}}))}},{key:"nextStep",value:function(){this.setState((function(e){return{graphIndex:e.graphIndex+1}}))}},{key:"prevContinue",value:function(){for(var e=this.state.contIndices.length-1;e>=0;e--)if(this.state.contIndices[e]<this.state.graphIndex)return void this.setState({graphIndex:this.state.contIndices[e]})}},{key:"nextContinue",value:function(){for(var e=0;e<this.state.contIndices.length;e++)if(this.state.contIndices[e]>this.state.graphIndex)return void this.setState({graphIndex:this.state.contIndices[e]})}},{key:"render",value:function(){var e=this,t=s.a.createElement(S.a,{id:"resetButtonTooltip"},"Reset all clauses.",s.a.createElement("strong",null,"Proceed with caution!")),n=s.a.createElement(S.a,{id:"prevButtonTooltip"},"Go to previous decision diagram."),a=s.a.createElement(S.a,{id:"prevContButtonTooltip"},"Go to previous conflict level."),r=s.a.createElement(S.a,{id:"nextButtonTooltip"},"Go to next decision diagram."),i=s.a.createElement(S.a,{id:"nextContButtonTooltip"},"Go to next conflict level."),c=s.a.createElement(j.a,{id:"resultButtonTooltip",title:"Solver Result"},"These CNF clauses have a result of ".concat(this.state.isSat?"SAT":"UNSAT"));return s.a.createElement("div",{className:"clause-visualizer"},s.a.createElement("div",{className:"clause-strs-wrapper",ref:this.clauseRef},s.a.createElement("div",{className:"clause-strs-container-header"},s.a.createElement("div",{className:"title"},"Clauses")),s.a.createElement("div",{className:"clause-strs-container"},s.a.createElement("div",{className:"clause-strs"},Object.entries(this.state.clauseStrs).map((function(e){var t=Object(C.a)(e,2),n=t[0],a=t[1];return s.a.createElement("div",{className:"clause-pair",key:n},s.a.createElement(k.a,{bsStyle:"info"},n),s.a.createElement(w.a,{bsSize:"small"},a))})),this.state.contIndices.map((function(t,n){return s.a.createElement("div",{style:{visibility:t>e.state.graphIndex?"hidden":"initial",height:t>e.state.graphIndex?"0":"auto"},className:"conflict-clause",key:"conflict".concat(n),ref:e.conflictRefs[n]},s.a.createElement(k.a,{bsStyle:"warning"},"conflict - clause".concat(Object.entries(e.state.clauseStrs).length+n+1)),s.a.createElement(w.a,{bsSize:"small"},e.state.confClauses[n]))}))),s.a.createElement("div",{className:"clause-strs-button-container"},s.a.createElement(T.a,{placement:"top",overlay:t},s.a.createElement(R.a,{bsStyle:"primary",onClick:this.props.onResetClauseClick},"Reset clause"))))),s.a.createElement("div",{className:"graph-wrapper"},s.a.createElement("div",{className:"graph-container-header"},s.a.createElement("div",{className:"title"},"Interactive CDCL | Results")),s.a.createElement("div",{className:"graph-container"},s.a.createElement(O,{className:"graph",dotStr:this.state.graphStrs[this.state.graphIndex]}),s.a.createElement("div",{className:"graph-button-container"},s.a.createElement("div",null,s.a.createElement(T.a,{placement:"top",overlay:a},s.a.createElement(R.a,{bsStyle:"primary",onClick:function(){return e.prevContinue()},disabled:0===this.state.contIndices.length||this.state.graphIndex<=this.state.contIndices[0]},"<< Prev Continue"))),s.a.createElement("div",null,s.a.createElement(T.a,{placement:"top",overlay:n},s.a.createElement(R.a,{bsStyle:"primary",onClick:function(){return e.prevStep()},disabled:0===this.state.graphIndex},"< Prev Step"))),s.a.createElement("div",null,s.a.createElement(T.a,{placement:"top",trigger:"click",overlay:c},s.a.createElement(R.a,{bsStyle:"primary"},"Reveal Result"))),s.a.createElement("div",null,s.a.createElement(T.a,{placement:"top",overlay:r},s.a.createElement(R.a,{bsStyle:"primary",onClick:function(){return e.nextStep()},disabled:this.state.graphIndex===this.state.graphStrs.length-1},"Next Step >"))),s.a.createElement("div",null,s.a.createElement(T.a,{placement:"top",overlay:i},s.a.createElement(R.a,{bsStyle:"primary",onClick:function(){return e.nextContinue()},disabled:0===this.state.contIndices.length||this.state.graphIndex>=this.state.contIndices[this.state.contIndices.length-1]},"Next Continue >>")))))))}}]),t}(a.Component)),U=n(86),D=n.n(U);function L(e){var t;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o.a.awrap(D.a.post("/clauses",e));case 3:return t=n.sent,n.abrupt("return",t);case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),null,null,[[0,7]])}var z=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={currentStep:0,serverResponse:null},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"visualizeClauses",value:function(e){this.setState({currentStep:this.state.currentStep+1,serverResponse:e})}},{key:"resetClauses",value:function(){this.setState({currentStep:0,inputs:["clause1"],inputIndex:2,serverResponse:null})}},{key:"handleUserInput",value:function(e){}},{key:"onSubmit",value:function(e){var t;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.a.awrap(L(e));case 2:"success"===(t=n.sent).data.status?this.visualizeClauses(t):alert("Server failed to give a response with an error message: "+t.data.error+". Please try different clauses!");case 4:case"end":return n.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"graph-input-wrapper"},0===this.state.currentStep&&s.a.createElement(x,{onSubmit:function(t){return e.onSubmit(t)}}),1===this.state.currentStep&&!!this.state.serverResponse&&s.a.createElement(N,{clauseInfo:this.state.serverResponse,onResetClauseClick:function(){return e.resetClauses()}}))}}]),t}(a.Component);n(253);i.a.render(s.a.createElement(z,null),document.getElementById("root"))}},[[154,1,2]]]);
//# sourceMappingURL=main.a9e6a40b.chunk.js.map